{
  "Author": "This document was written by Will Dormann.",
  "CAM_AttackerAccessRequired": "0",
  "CAM_EaseOfExploitation": "0",
  "CAM_Exploitation": "0",
  "CAM_Impact": "0",
  "CAM_InternetInfrastructure": "0",
  "CAM_Population": "0",
  "CAM_ScoreCurrent": 0,
  "CAM_ScoreCurrentWidelyKnown": 0,
  "CAM_ScoreCurrentWidelyKnownExploited": 0,
  "CAM_WidelyKnown": "0",
  "CERTAdvisory": "",
  "CVEIDs": "CVE-2018-8440",
  "CVSS_AccessComplexity": "L",
  "CVSS_AccessVector": "L",
  "CVSS_Authenication": "S",
  "CVSS_AvailabilityImpact": "C",
  "CVSS_BaseScore": 6.8,
  "CVSS_BaseVector": "AV:L/AC:L/Au:S/C:C/I:C/A:C",
  "CVSS_CollateralDamagePotential": "ND",
  "CVSS_ConfidentialityImpact": "C",
  "CVSS_EnvironmentalScore": 6.4310679552,
  "CVSS_EnvironmentalVector": "CDP:ND/TD:H/CR:ND/IR:ND/AR:ND",
  "CVSS_Exploitability": "F",
  "CVSS_IntegrityImpact": "C",
  "CVSS_RemediationLevel": "U",
  "CVSS_ReportConfidence": "C",
  "CVSS_SecurityRequirementsAR": "ND",
  "CVSS_SecurityRequirementsCR": "ND",
  "CVSS_SecurityRequirementsIR": "ND",
  "CVSS_TargetDistribution": "H",
  "CVSS_TemporalScore": 6.5,
  "CVSS_TemporalVector": "E:F/RL:U/RC:C",
  "DateCreated": "2018-08-27T17:46:35-04:00",
  "DateFirstPublished": "2018-08-27T22:17:28-04:00",
  "DateLastUpdated": "2018-09-13T16:15:00-04:00",
  "DatePublic": "2018-08-27T00:00:00",
  "Description": "The Microsoft Windows task scheduler SchRpcSetSecurity API contains a vulnerability in the handling of ALPC, which can allow an authenticated user to overwrite the contents of a file that should be protected by filesystem ACLs. This can be leveraged to gain SYSTEM privileges. We have confirmed that the public exploit code works on 64-bit Windows 10 and Windows Server 2016 systems. We have also confirmed compatibility with 32-bit Windows 10 with minor modifications to the public exploit code. Compatibility with other Windows versions is possible with further modifications. This vulnerability is being exploited in the wild.",
  "ID": "VU#906424",
  "IDNumber": "906424",
  "IPProtocol": "",
  "Impact": "An authenticated local user may be able to gain elevated (SYSTEM) privileges.",
  "Keywords": "",
  "Overview": "Microsoft Windows task scheduler contains a local privilege escalation vulnerability in the Advanced Local Procedure Call (ALPC) interface, which can allow a local user to obtain SYSTEM privileges.",
  "References": [
    "https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2018-8440",
    "https://github.com/SandboxEscaper/randomrepo/blob/master/PoC-LPE.rar",
    "https://doublepulsar.com/task-scheduler-alpc-exploit-high-level-analysis-ff08cda6ad4f",
    "https://msdn.microsoft.com/en-us/library/cc248452.aspx",
    "https://twitter.com/karsten_nilsen/status/1034406706879578112",
    "https://www.welivesecurity.com/2018/09/05/powerpool-malware-exploits-zero-day-vulnerability/"
  ],
  "Resolution": "Apply an update This issue is addressed in the Microsoft update for CVE-2018-8440.",
  "Revision": 68,
  "SystemsAffectedPreamble": "",
  "ThanksAndCredit": "This issue was publicly disclosed by SandboxEscaper.",
  "Title": "Microsoft Windows task scheduler contains a local privilege escalation vulnerability in the ALPC interface",
  "US-CERTTechnicalAlert": "",
  "VRDA_D1_DirectReport": "0",
  "VRDA_D1_Impact": "2",
  "VRDA_D1_Population": "4",
  "VulnerabilityCount": 1,
  "Workarounds": "Deploy Microsoft Sysmon Detection Rules Kevin Beaumont has provided guidance for creating rules to detect exploitation of this vulnerability. Set ACLs on the C:\\Windows\\Tasks directory Karsten Nilsen has provided a mitigation for this vulnerability. Caution: This mitigation has not been approved by Microsoft. However, in our testing it does block exploits for this vulnerability. It also appears to let scheduled tasks to continue to run, and users can continue to create new scheduled tasks as necessary. However, this change will reportedly break things created by the legacy task scheduler interface. This can include things like SCCM and the associated SCEP updates. Please ensure that you have tested this mitigation to ensure that it does not cause unacceptable consequences in your environment. To apply this mitigation,  run the following commands in an elevated-privilege prompt,: icacls c:\\windows\\tasks /remove:g \"Authenticated Users\"\nicacls c:\\windows\\tasks /deny system:(OI)(CI)(WD,WDAC) Note that when a fix is made available for this vulnerability, these changes should be undone. This can be done by executing the following commands: icacls c:\\windows\\tasks /remove:d system\nicacls c:\\windows\\tasks /grant:r \"Authenticated Users\":(RX,WD)"
}