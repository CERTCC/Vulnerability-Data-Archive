{
  "Author": "This document was written by Will Dormann, Laurie Tyzenhaus and Madison Oliver.",
  "CAM_AttackerAccessRequired": "0",
  "CAM_EaseOfExploitation": "0",
  "CAM_Exploitation": "0",
  "CAM_Impact": "0",
  "CAM_InternetInfrastructure": "0",
  "CAM_Population": "0",
  "CAM_ScoreCurrent": 0,
  "CAM_ScoreCurrentWidelyKnown": 0,
  "CAM_ScoreCurrentWidelyKnownExploited": 0,
  "CAM_WidelyKnown": "0",
  "CERTAdvisory": "",
  "CVEIDs": "CVE-2019-15846 ",
  "CVSS_AccessComplexity": "L",
  "CVSS_AccessVector": "N",
  "CVSS_Authenication": "N",
  "CVSS_AvailabilityImpact": "C",
  "CVSS_BaseScore": 10,
  "CVSS_BaseVector": "AV:N/AC:L/Au:N/C:C/I:C/A:C",
  "CVSS_CollateralDamagePotential": "ND",
  "CVSS_ConfidentialityImpact": "C",
  "CVSS_EnvironmentalScore": 5.86926702432,
  "CVSS_EnvironmentalVector": "CDP:ND/TD:M/CR:ND/IR:ND/AR:ND",
  "CVSS_Exploitability": "POC",
  "CVSS_IntegrityImpact": "C",
  "CVSS_RemediationLevel": "OF",
  "CVSS_ReportConfidence": "C",
  "CVSS_SecurityRequirementsAR": "ND",
  "CVSS_SecurityRequirementsCR": "ND",
  "CVSS_SecurityRequirementsIR": "ND",
  "CVSS_TargetDistribution": "M",
  "CVSS_TemporalScore": 7.8,
  "CVSS_TemporalVector": "E:POC/RL:OF/RC:C",
  "DateCreated": "2019-09-06T11:03:09-04:00",
  "DateFirstPublished": "2019-09-06T13:34:30-04:00",
  "DateLastUpdated": "2019-10-16T14:55:00-04:00",
  "DatePublic": "2019-09-06T00:00:00",
  "Description": "Exim is a message transfer agent (MTA) that can be used on Unix-like operating systems. All versions up to and including 4.92.1 of Exim do not properly handle trailing backslash characters in the string_interpret_escape() function, which is used to process peer DN and SNI during a TLS negotiation. In cases where the string being processed ends with a '\\' character, the vulnerable string_interpret_escape() function will interpret the string-terminating null byte as a value to be escaped, thus incrementing the string pointer to the byte after the string to be processed. If the attacker-provided data is crafted in a certain way, this out-of-bounds pointer can be leveraged to cause a heap overflow. Exim installations configured to allow TLS connections, which can happen either via the SMTP STARTTLS command or via TLS-on-connect, can process attacker-provided data in the TLS SNI information. Exim installations that are configured to process client-provided certificates may also be exploitable via a crafted TLS peer DN.",
  "ID": "VU#672565",
  "IDNumber": "672565",
  "IPProtocol": "",
  "Impact": "By causing a vulnerable Exim server to process an SMTP email message, a local or remote unauthenticated attacker may be able to execute arbitrary code with root privileges.",
  "Keywords": [
    "Exim",
    "TLS",
    "CVE-2019-15846",
    "tls_sni",
    "tls_peerdn"
  ],
  "Overview": "Exim versions up to and including 4.92.1 do not properly handle trailing backslash characters in the string_interpret_escape() function. This function is used to handle peer distinguished names (DN) and Sever Name Indication (SNI) during a TLS negotiation. This vulnerability could allow a local or remote unauthenticated attacker to execute arbitrary code with root privileges.",
  "References": [
    "https://www.exim.org/static/doc/security/CVE-2019-15846.txt",
    "https://ftp.exim.org/pub/exim/exim4/",
    "https://github.com/Exim/exim.git",
    "https://usn.ubuntu.com/4124-1/",
    "https://github.com/Exim/exim/tree/exim-4.92.2%2Bfixes/doc/doc-txt/cve-2019-15846",
    "https://git.exim.org/exim.git/commit/2600301ba6dbac5c9d640c87007a07ee6dcea1f4",
    "https://www.bleepingcomputer.com/news/security/millions-of-exim-mail-servers-are-currently-being-attacked/",
    "https://www.bleepingcomputer.com/news/security/critical-exim-tls-flaw-lets-attackers-remotely-execute-commands-as-root/"
  ],
  "Resolution": "Apply an update\nThis vulnerability is addressed in Exim 4.92.2. For further information see the Exim advisory for CVE-2019-15846.",
  "Revision": 88,
  "SystemsAffectedPreamble": "",
  "ThanksAndCredit": "Thanks to Zerons for the initial report to Exim and to Qualys for providing additional analysis.",
  "Title": "Exim fails to properly handle trailing backslashes in string_interpret_escape()",
  "US-CERTTechnicalAlert": "",
  "VRDA_D1_DirectReport": "0",
  "VRDA_D1_Impact": "4",
  "VRDA_D1_Population": "2",
  "VulnerabilityCount": 1,
  "Workarounds": "Use ACLs to block attack attempts\nThe Exim advisory provides ACLs to deny email messages with trailing backslashes in TLS SNI or peer DN fields: # to be prepended to your mail acl (the ACL referenced\n# by the acl_smtp_mail main config option)\ndeny    condition = ${if eq{\\\\}{${substr{-1}{1}{$tls_in_sni}}}}\ndeny    condition = ${if eq{\\\\}{${substr{-1}{1}{$tls_in_peerdn}}}}"
}