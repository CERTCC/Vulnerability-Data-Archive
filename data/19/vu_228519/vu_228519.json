{
  "Author": "This document was written by Joel Land.",
  "CAM_AttackerAccessRequired": "0",
  "CAM_EaseOfExploitation": "0",
  "CAM_Exploitation": "0",
  "CAM_Impact": "0",
  "CAM_InternetInfrastructure": "0",
  "CAM_Population": "0",
  "CAM_ScoreCurrent": 0,
  "CAM_ScoreCurrentWidelyKnown": 0,
  "CAM_ScoreCurrentWidelyKnownExploited": 0,
  "CAM_WidelyKnown": "0",
  "CERTAdvisory": "",
  "CVEIDs": [
    "CVE-2017-13077",
    "CVE-2017-13078",
    "CVE-2017-13079",
    "CVE-2017-13080",
    "CVE-2017-13081",
    "CVE-2017-13082",
    "CVE-2017-13084",
    "CVE-2017-13086",
    "CVE-2017-13087",
    "CVE-2017-13088"
  ],
  "CVSS_AccessComplexity": "M",
  "CVSS_AccessVector": "A",
  "CVSS_Authenication": "N",
  "CVSS_AvailabilityImpact": "P",
  "CVSS_BaseScore": 5.4,
  "CVSS_BaseVector": "AV:A/AC:M/Au:N/C:P/I:P/A:P",
  "CVSS_CollateralDamagePotential": "ND",
  "CVSS_ConfidentialityImpact": "P",
  "CVSS_EnvironmentalScore": 5.73330580767835,
  "CVSS_EnvironmentalVector": "CDP:ND/TD:H/CR:H/IR:H/AR:ND",
  "CVSS_Exploitability": "POC",
  "CVSS_IntegrityImpact": "P",
  "CVSS_RemediationLevel": "ND",
  "CVSS_ReportConfidence": "C",
  "CVSS_SecurityRequirementsAR": "ND",
  "CVSS_SecurityRequirementsCR": "H",
  "CVSS_SecurityRequirementsIR": "H",
  "CVSS_TargetDistribution": "H",
  "CVSS_TemporalScore": 4.9,
  "CVSS_TemporalVector": "E:POC/RL:ND/RC:C",
  "DateCreated": "2017-08-15T18:18:57-04:00",
  "DateFirstPublished": "2017-10-16T07:39:36-04:00",
  "DateLastUpdated": "2018-03-21T17:10:00-04:00",
  "DatePublic": "2017-10-16T00:00:00",
  "Description": "CWE-323: Reusing a Nonce, Key Pair in Encryption Wi-Fi Protected Access II (WPA2) handshake traffic can be manipulated to induce nonce and session key reuse, resulting in key reinstallation by a victim wireless access point (AP) or client. After establishing a man-in-the-middle position between an AP and client, an attacker can selectively manipulate the timing and transmission of messages in the WPA2 Four-way, Group Key, Fast Basic Service Set (BSS) Transition, PeerKey, Tunneled Direct-Link Setup (TDLS) PeerKey (TPK), or Wireless Network Management (WNM) Sleep Mode handshakes, resulting in out-of-sequence reception or retransmission of messages. Depending on the data confidentiality protocols in use (e.g. TKIP, CCMP, and GCMP) and situational factors, the effect of these manipulations is to reset nonces and replay counters and ultimately to reinstall session keys. Key reuse facilitates arbitrary packet decryption and injection, TCP connection hijacking, HTTP content injection, or the replay of unicast, broadcast, and multicast frames. The following CVE IDs have been assigned to document these vulnerabilities in the WPA2 protocol: CVE-2017-13077: reinstallation of the pairwise key in the Four-way handshake\nCVE-2017-13078: reinstallation of the group key in the Four-way handshake\nCVE-2017-13079: reinstallation of the integrity group key in the Four-way handshake\nCVE-2017-13080: reinstallation of the group key in the Group Key handshake\nCVE-2017-13081: reinstallation of the integrity group key in the Group Key handshake\nCVE-2017-13082: accepting a retransmitted Fast BSS Transition Reassociation Request and reinstalling the pairwise key while processing it\nCVE-2017-13084: reinstallation of the STK key in the PeerKey handshake\nCVE-2017-13086: reinstallation of the Tunneled Direct-Link Setup (TDLS) PeerKey (TPK) key in the TDLS handshake\nCVE-2017-13087: reinstallation of the group key (GTK) when processing a Wireless Network Management (WNM) Sleep Mode Response frame\nCVE-2017-13088: reinstallation of the integrity group key (IGTK) when processing a Wireless Network Management (WNM) Sleep Mode Response frame For a detailed description of these issues, refer to the researcher's website and paper.",
  "ID": "VU#228519",
  "IDNumber": "228519",
  "IPProtocol": "",
  "Impact": "An attacker within the wireless communications range of an affected AP and client may leverage these vulnerabilities to conduct attacks that are dependent on the data confidentiality protocol being used. Impacts may include arbitrary packet decryption and injection, TCP connection hijacking, HTTP content injection, or the replay of unicast, broadcast, and multicast frames.",
  "Keywords": [
    "cryptography",
    "wpa2",
    "wifi",
    "nonce reuse",
    "session key",
    "krack"
  ],
  "Overview": "Wi-Fi Protected Access (WPA, more commonly WPA2) handshake traffic can be manipulated to induce nonce and session key reuse, resulting in key reinstallation by a wireless access point (AP) or client. An attacker within range of an affected AP and client may leverage these vulnerabilities to conduct attacks that are dependent on the data confidentiality protocols being used. Attacks may include arbitrary packet decryption and injection, TCP connection hijacking, HTTP content injection, or the replay of unicast and group-addressed frames. These vulnerabilities are referred to as Key Reinstallation Attacks or \"KRACK\" attacks.",
  "References": [
    "https://cwe.mitre.org/data/definitions/323.html",
    "https://www.krackattacks.com/",
    "https://papers.mathyvanhoef.com/ccs2017.pdf"
  ],
  "Resolution": "Install Updates The WPA2 protocol is ubiquitous in wireless networking. The vulnerabilities described here are in the standard itself as opposed to individual implementations thereof; as such, any correct implementation is likely affected. Users are encouraged to install updates to affected products and hosts as they are available. For information about a specific vendor or product, check the Vendor Information section of this document or contact the vendor directly. Note that the vendor list below is not exhaustive.",
  "Revision": 144,
  "SystemsAffectedPreamble": "",
  "ThanksAndCredit": "Thanks to Mathy Vanhoef of the imec-DistriNet group at KU Leuven for reporting these vulnerabilities. Mathy thanks John A. Van Boxtel for finding that wpa_supplicant v2.6 is also vulnerable to CVE-2017-13077. The CERT/CC also thanks ICASI for their efforts to facilitate vendor collaboration on addressing these vulnerabilities.",
  "Title": "Wi-Fi Protected Access (WPA) handshake traffic can be manipulated to induce nonce and session key reuse",
  "US-CERTTechnicalAlert": "",
  "VRDA_D1_DirectReport": "1",
  "VRDA_D1_Impact": "3",
  "VRDA_D1_Population": "4",
  "VulnerabilityCount": 10,
  "Workarounds": ""
}